# タグ管理機能 - 設計書

## 📋 概要

NotebookLMの各ノートブックにユーザー定義のタグを追加し、効率的に整理・検索できる機能を実装します。

## 🎯 解決したい課題

### 現状の問題
- ノートブックが増えると、目的の記事を見つけるのが困難
- NotebookLMのアイコンだけでは分類が不十分
- プロジェクトや研究テーマごとの整理ができない

### この機能で実現すること
1. **自由なカテゴリ分け**: ユーザーが自由にタグを作成
2. **複数タグ対応**: 1つのノートブックに複数のタグを設定可能
3. **高度な検索**: タグの組み合わせで絞り込み検索
4. **視覚的な整理**: タグの色分けでひと目で分類を確認

## 🏗️ 技術設計

### データ構造

```javascript
// Chrome Storage に保存するデータ形式
{
  "tags": {
    "notebook-id-1": ["勉強", "AI", "重要"],
    "notebook-id-2": ["仕事", "プレゼン"],
    "notebook-id-3": ["勉強", "数学"]
  },
  "tagColors": {
    "勉強": "#FF6B6B",
    "仕事": "#4ECDC4",
    "AI": "#45B7D1",
    "重要": "#FFA07A"
  }
}
```

### UI設計

```
┌─────────────────────────────────┐
│ 🏷️ タグフィルター              │
│ ┌─────┐ ┌─────┐ ┌─────┐     │
│ │ 勉強 │ │ 仕事 │ │ AI  │ ... │
│ └─────┘ └─────┘ └─────┘     │
└─────────────────────────────────┘

┌─────────────────────────────────┐
│ 📚 ノートブック                 │
│ ┌─────────────────────────┐   │
│ │ タイトル: AI入門         │   │
│ │ 🏷️ 勉強 AI 重要         │   │
│ │ [➕タグ追加] [🎵音声]   │   │
│ └─────────────────────────┘   │
└─────────────────────────────────┘
```

### 実装ファイル

1. **src/sidepanel/components/tags.js**
   - タグ管理のメインロジック
   - タグの追加・削除・編集機能

2. **src/sidepanel/styles/tags.css**
   - タグのスタイリング
   - 色分け、アニメーション

3. **src/storage/tagStorage.js**
   - Chrome Storage APIのラッパー
   - データの保存・読み込み

## 🔧 実装手順

### Phase 1: 基本機能（今回実装）
- [ ] タグの追加・削除機能
- [ ] Chrome Storageへの保存
- [ ] 各ノートブックへのタグ表示
- [ ] 基本的なスタイリング

### Phase 2: フィルタリング機能
- [ ] タグによる絞り込み
- [ ] AND/OR検索
- [ ] タグの一括操作

### Phase 3: 高度な機能
- [ ] タグの色カスタマイズ
- [ ] タグのインポート/エクスポート
- [ ] タグの使用統計

## 📝 ユーザーストーリー

### ストーリー1: タグの追加
```
1. ユーザーがノートブックの「タグ追加」ボタンをクリック
2. 入力フィールドが表示される
3. タグ名を入力（例：「勉強」）
4. Enterキーまたは追加ボタンで保存
5. タグがノートブックに表示される
```

### ストーリー2: タグでフィルタリング
```
1. 上部のタグフィルターエリアでタグをクリック
2. 選択したタグを持つノートブックのみ表示
3. 複数タグを選択可能（AND検索）
4. タグを再度クリックで解除
```

## 🧪 テスト項目

1. **機能テスト**
   - タグの追加が正しく動作するか
   - タグの削除が正しく動作するか
   - データが永続化されるか

2. **エッジケース**
   - 長いタグ名の処理
   - 特殊文字を含むタグ
   - 大量のタグ（パフォーマンス）

3. **UIテスト**
   - レスポンシブデザイン
   - アクセシビリティ
   - 使いやすさ

## 🎨 デザイン仕様

### カラーパレット
- プライマリ: `#1a73e8` (Google Blue)
- 成功: `#34a853` (Green)
- 警告: `#fbbc04` (Yellow)
- エラー: `#ea4335` (Red)
- 背景: `#f8f9fa`

### タグのスタイル
```css
.tag {
  display: inline-block;
  padding: 4px 12px;
  border-radius: 16px;
  font-size: 12px;
  margin: 2px;
  cursor: pointer;
  transition: all 0.2s;
}

.tag:hover {
  transform: translateY(-1px);
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}
```

## 📊 成功指標

1. **使いやすさ**: 3クリック以内でタグを追加
2. **パフォーマンス**: 100個のタグでも遅延なし
3. **採用率**: ユーザーの70%以上がタグ機能を使用